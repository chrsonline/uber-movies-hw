{"version":3,"sources":["Application.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["'use strict';\n\njQuery(document).ready(function () {\n    var map;\n\n    var options = {\n        zoom: 11,\n        center:  new google.maps.LatLng(37.793, -122.394),\n        mapTypeId: google.maps.MapTypeId.ROADMAP,\n        // disable default UI and add an icon\n    };\n\n    map = new google.maps.Map($('#map')[0], options);\n\n    var app = {};\n\n    app.Suggestion = Backbone.Model.extend({\n      defaults: {\n        term: 'aa',\n        type: 'ss',\n        selected: false\n      }\n    });\n\n    app.SuggestionView = Backbone.View.extend({\n      tagName: 'li',\n      className: 'suggestionBox',\n      template: _.template('<%- term %>'),\n      initialize: function() {\n        this.model.on('destroy', this.remove, this);\n        this.model.on('change:selected', this.setSelected, this);\n      },\n      setSelected: function() {\n        this.$el.toggleClass('suggestionBoxSelected', this.model.get('selected'));\n      },\n      render: function() {\n        this.$el.html(this.template(this.model.toJSON()));\n        return this;\n      }\n    });\n\n    app.Suggestions = Backbone.Collection.extend({\n      initialize: function() {\n        this.selected = null;\n      },\n      navigateUp: function() {\n        var index = this.indexOf(this.selected);\n        if(index < 0) {\n            return false;\n        }\n        if(index == 0) {\n            this.selected.set({ selected: false });\n            this.selected = null;\n        } else {\n            this.setSelected(this.at(index - 1));\n        }\n      },\n      navigateDown: function() {\n        if(this.length > 0 && this.selected == null) {\n            this.setSelected(this.at(0));\n        } else {\n          var index = this.indexOf(this.selected);\n          if(index < this.length - 1) {\n              this.setSelected(this.at(index + 1));\n          }\n        }\n      },\n      setSelected: function(suggestion) {\n        if(this.selected != null) {\n          this.selected.set({ selected: false });\n        }\n        suggestion.set({ selected: true });\n        this.selected = suggestion;\n      },\n      url: function () {\n        return '/search/autocomplete?query=' + $('#search-term').val();\n      },\n      parse: function(data) {\n        return data.suggestions;\n      },\n      model: app.Suggestion\n    });\n\n    app.AutocompleteView = Backbone.View.extend({\n      el: '#search',\n      initialize: function() {\n          this.suggestions = new app.Suggestions();\n          this.suggestions.on('reset', this.addAll, this );\n          this.ignoreKey = false;\n      },\n      events: {\n          \"input #search-term\": \"updateItems\",\n          'keydown :input': 'handleKeyPress',\n          'keypress :input': 'handleKeyPress',\n          'keyup :input': 'handleEnterUp'\n      },\n      handleKeyPress: function(e) {\n        if (e.keyCode == 40) {\n            this.suggestions.navigateDown();\n            return false;\n        }\n        if (e.keyCode == 38) {\n           this.suggestions.navigateUp();\n           return false;\n        }\n\n        return true;\n      },\n      handleEnterUp: function(e) {\n        if(e.keyCode == 13) {\n          this.suggestions.reset();\n\n          if(this.suggestions.selected != null) {\n            $('#search-term').val( this.suggestions.selected.get('term') );\n            app.resultsView.updateItems();\n          }\n        }\n      },\n      updateItems: function () {\n          this.suggestions.fetch();\n      },\n      addOne: function(suggestion) {\n        var view = new app.SuggestionView({model: suggestion});\n        this.$el.find('ul').append(view.render().el);\n      },\n      addAll: function () {\n        this.$el.find('ul').empty();\n        this.suggestions.each( $.proxy( this.addOne, this ) );\n      },\n      render: function (suggestions) {\n\n      }\n    });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    app.Location = Backbone.Model.extend({\n      defaults: {\n        title: '',\n        release_year: '',\n        production_company: '',\n        distributor: '',\n        director: '',\n        writer: '',\n        facts: '',\n        location: '',\n        latitude: '',\n        longitude: '',\n        actors: []\n      },\n      initialize: function(attributes) {\n        this.map = attributes.map;\n        var view = new app.LocationView({model: this, map: this.map});\n        view.render();\n      }\n    });\n\n\n    app.LocationView = Backbone.View.extend({\n      tagName:  \"li\",\n      initialize: function(options) {\n        this.map = options.map;\n        this.model = options.model;\n\n        this.marker = new google.maps.Marker({\n            map: this.map,\n            position: new google.maps.LatLng(this.model.get('geocode_information').latitude, this.model.get('geocode_information').longitude),\n            animation: google.maps.Animation.DROP,\n            title: this.model.get('location'),\n            facts: this.model.get('facts'),\n            actors: this.model.get('actors'),\n            id : this.model.get('id')\n        });\n\n        this.marker.infowindow = new google.maps.InfoWindow({\n          content: this.marker.title\n        });\n\n        google.maps.event.addListener(this.marker, 'mouseover', this.showPopover);\n        google.maps.event.addListener(this.marker, 'mouseout', this.hidePopover);\n\n        this.model.on('remove', this.removeMarker, this);\n      },\n      hidePopover : function() {\n        this.infowindow.close();\n      },\n      showPopover : function() {\n        this.infowindow.open(this.map, this);\n      },\n      removeMarker : function() {\n        this.marker.setMap(null);\n        this.marker = null;\n      }\n    });\n\n    app.SearchResults = Backbone.Collection.extend({\n      initialize: function (models, options) {\n        this.map = options.map;\n      },\n      url: function () {\n        return '/search/movies?query=' + $('#search-term').val();\n      },\n      parse: function(data) {\n        var index;\n        for (index = 0; index < data.length; ++index) {\n            data[index].map = this.map;\n        }\n        return data;\n      },\n      model: app.Location\n    });\n\n    app.ResultsView = Backbone.View.extend({\n      initialize: function (options) {\n        this.map = options.map;\n        this.results = new app.SearchResults([], { map: this.map });\n      },\n      updateItems: function() {\n        var remove = [];\n        this.results.each(function(result) {\n          remove.push(result);\n        });\n        this.results.remove(remove);\n\n        this.results.fetch();\n      }\n    });\n\n    app.autocompleteView = new app.AutocompleteView();\n    app.resultsView = new app.ResultsView({ map: map });\n\n    $('#search-term').keydown(function(e) {\n      var code = (e.keyCode ? e.keyCode : e.which);\n      if (code == 13) {\n            // also have a little search button to be pressed\n            // Display the current search term - no results if nothing\n            // Display aggregate information in panel overlayed on the left side\n            // Clear current search results if necessary\n            // Kick off searchresults collection with call of type/term\n      }\n\n    });\n});\n"],"sourceRoot":"/source/"}